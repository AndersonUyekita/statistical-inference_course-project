---
author: 'Anderson Hitoshi Uyekita'
date: !r lubridate::today(tzone = "America/Sao_Paulo")
output: pdf_document
---

# Statistical inference - Course Project: Part 1

* Author: `r 'Anderson Hitoshi Uyekita'`
* Date: `r lubridate::today(tzone = "America/Sao_Paulo")`

## Synopsis

This exercise aims to show the power of the central limit theorem (CLT), comparing simulation results with theoretical expectations. The activity is based on a sample of 1,000 means generated by 40 numbers (with an exponential distribution profile with lambda 0.2). Then comparing those values (the sample and theoretical) to prove the CLT. As a result, a graph was plotted showing the sample's normality, confirming the CLT.

## 1. Objectivies

* Show the sample mean and compare it to the theoretical mean of the distribution.
* Show how variable the sample is (via variance) and compare it to the theoretical variance of the distribution.
* Show that the distribution is approximately normal.

## 2. Requeriments and Settings

Please find the requirements and Settings to reproduce this experiment in the APPENDIX section or Forking the [Github Repository]().

```{r loading_packages,echo=FALSE,warning=FALSE}
# Loading libraries
library(ggplot2)

# Force results to be in English
invisible(Sys.setlocale("LC_ALL","English"))

# Set seed
set.seed(2022)
```

## 3. Parameters

According to Part 1 of the Course Project, the parameters of this assignment should be:

```{r sampling_settings, echo = TRUE}
# Parameters
simulations <- 1000; sample_size <- 40; lambda <- 0.2
```

Preparing data to make an analysis:

```{r sampling, echo = TRUE}
raw_sample_exponential <- replicate(simulations, rexp(sample_size, lambda))
sample_exponential <- apply(raw_sample_exponential, 2, mean)
```

The dataset created is a vector with 1000 of "means".

## 4. Sample Mean versus Theoretical Mean

**Theoretical Mean**: The Theoretical mean of a exponential distribution rate is the inverse of lambda
```{r theo_mean, echo = TRUE}
theoretical_mean = 1 / lambda
```

So in this exercise the theorical mean is `r theoretical_mean`.

**Sample Mean**: The sample mean is showed bellow 
```{r sample_mean, echo = TRUE}
sample_mean <- mean(sample_exponential)
```

The sample mean is `r sample_mean`.

#### Conclusions
Based on the results above, those means are very close due to the great amount of samples and simulations. This exercise shows the application of the Central Limit Theorem.


## 5. Sample Variance  versus Theoretical Variance

To calculate the variance is necessary one step before calculating the standard deviation. Thus, this section is divided into 2 parts.

**Theoretical Standard Deviation**: The standard deviation is calculated analytically as follow 
```{r theo_sd, echo = TRUE}
theoretical_sd <- (1/lambda)/(sqrt(sample_size))
```

So in this exercise the theorical standard deviantion is `r theoretical_sd`.

**Sample Standard Deviation**: The sample standard deviation is showed bellow 
```{r sample_sd, echo = TRUE}
sample_sd <- sd(sample_exponential)
```

The sample standard deviation is `r sample_sd`.

Using the standard deviation calculated above. It is possible to calculate the variances.

**Theoretical Variance**: The Variance is the square of the standard deviation
```{r theo_variance, echo = TRUE}
theoretical_varicane <- theoretical_sd^2
```
So in this exercise the theorical variance is `r theoretical_varicane`.


**Sample Variance**:
```{r sample_variance, echo = TRUE}
sample_variance <- sd(sample_exponential)
```
The sample variance is `r sample_variance`.

#### Conclusions
Based on the results above, those variances are very close due to the great amount of samples and simulations. This exercise shows the application of the Central Limit Theorem.


## 6. Show that the distribution is approximately normal

Using graphs this question could be easily answered
```{r is_normal, echo = TRUE}

# Histogram of averages
hist(sample_exponential, breaks=20, prob=TRUE,
     main="Comparison of simulation results and theoretical expected (lambda=0.2)",
     xlab="")

# Draw a line of Density of the averages of samples
lines(density(sample_exponential),lwd=2,col="red")

# Theoretical center of distribution. In other words, the theretical mean.
abline(v=1/lambda, col="red",lwd=2)

# Theoretical density of the averages of the simulations samples
xfit <- seq(min(sample_exponential), max(sample_exponential), length=100)
yfit <- dnorm(xfit, mean=1/lambda, sd=(1/lambda/sqrt(sample_size)))

# Draw a line of Theoretical
lines(xfit, yfit, pch=20, col="blue", lty=4,lwd=2)

# Add legend in the histogram
legend('topright', c("simulation", "theoretical"), lty=c(1,2), col=c("red", "blue"),lwd=2)
```

#### Conclusions
The simulation is approximately normal. The graphic shows a histogram and a density line of a theoretical distribution, those informations are very close. Due to the central limit theorem, the averages of samples follow normal distribution.


<!-- Adding a Page Break to starting a new APPENDIX page -->
\newpage

\center

# APPENDIX

\raggedright

In order to reproduce this Course Project in any environment, please find below the Packages, Seed definition and `SessionInfo()`.

### Requirements

```r
# Loading libraries
library(ggplot2)

# Force results to be in English
Sys.setlocale("LC_ALL","English")

# Set seed
set.seed(2022)
```

### Session Info

```{r,echo=FALSE}
sessionInfo()
```