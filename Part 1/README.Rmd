---
title: '`Course Project` Statistical Inference'
author: '`r if(knitr::is_html_output()) {"&#x1f468;&#x1F3FB;&#x200d;&#x1f4bb; Anderson H Uyekita"} else {NULL}`'
output:
  html_document:
    toc: true
    toc_depth: 4
    toc_float:
      collapsed: false
      smooth_scroll: true
  github_document: default
params:
  author: "Anderson H Uyekita"
  course: 'Statistical Inference'
  course_url: 'https://www.coursera.org/learn/statistical-inference'
  specialization: 'Data Science: Statistics and Machine Learning Specialization'
  specialization_url: 'https://www.coursera.org/specializations/data-science-statistics-machine-learning'
  instructor: "Brian Caffo"
  course_start: !r lubridate::ymd("2022/07/01", tz = "America/Sao_Paulo")
  course_finish: !r lubridate::ymd("2022/07/04", tz = "America/Sao_Paulo")
  week: "Week 4"
  slug: 'Week%204'
  rpubs: 'https://rpubs.com/AndersonUyekita/course-project_statistical-inference'
  project_repo: 'https://github.com/AndersonUyekita/statistical-inference_course-project'
  codebook: 'https://github.com/AndersonUyekita/statistical-inference_course-project/blob/master/codebook.md'
  instructions: 'https://github.com/AndersonUyekita/statistical-inference_course-project/blob/master/instructions.md'
always_allow_html: true
---

```{r setup,include=FALSE}
knitr::opts_chunk$set(echo=TRUE,cache=TRUE,message=FALSE,warning=FALSE)
library(rmarkdown)
```

`r if(!knitr::is_html_output()) {sprintf(fmt = "* &#x1f468;&#x1F3FB;&#x200d;&#x1f4bb; Author: %s", params$author)}`
`r sprintf(fmt = "* &#x1f4da; Specialization: [%s](%s){target='_blank' rel='noopener'}", params$specialization, params$specialization_url)`
`r sprintf(fmt = "* &#x1f4d6; Course: [%s](%s){target='_blank' rel='noopener'}", params$course, params$course_url)`
    `r sprintf(fmt = "* &#x1F9D1;&#x200d;&#x1F3EB; Instructor: %s", params$instructor)`
`r sprintf(fmt = "* &#x1F4C6; %s", params$week)`
    `r sprintf(fmt = "* &#x1F6A6; Start: %s", format(params$course_start, "%A, %d %B %Y"))`
    `r sprintf(fmt = "* &#x1F3C1; Finish: %s", format(params$course_finish, "%A, %d %B %Y"))`

--------------------------------------------------------------------------------

# Part 1: Simulation Exercise

## Synopsis

Part 1 of the Course Project aims to show an understanding of the central limit theorem (CLT), comparing simulation results with theoretical expectations. The activity is based on a sample of 1,000 means generated by 40 numbers (with an exponential distribution profile with lambda 0.2). Then comparing those values (the sample and theoretical) to prove the CLT. As a result, a graph was plotted showing the normality of the sample's average, confirming the CLT.

## 1. Objectives

* Task 1: Show the sample mean and compare it to the theoretical mean of the distribution.
* Task 2: Show how variable the sample is (via variance) and compare it to the theoretical variance of the distribution.
* Task 3: Show that the distribution is approximately normal.

## 2. Requeriments and Settings

Please find the Requirements and Settings to reproduce this experiment in the APPENDIX section or Forking the [Github Repository](https://github.com/AndersonUyekita/statistical-inference_course-project/tree/main/Part%201).

```{r loading_packages,echo=FALSE,warning=FALSE}
# Loading libraries
library(ggplot2)

# Force results to be in English
base::invisible(Sys.setlocale("LC_ALL", "English.utf8"))

# Set seed
base::set.seed(2022)
```

## 3. Parameters

According to Part 1 of the Course Project, the parameters of this assignment should be:

```{r sampling_settings,echo=TRUE}
# Parameters
simulations <- 1000; sample_size <- 40; lambda <- 0.2
```

## 4. Simulations

Generating random data to create a dataset to answer the tasks posted on "1. Objectives".

```{r sampling,echo=TRUE}
# Adapting the source code given in the instructions.
mean_sample_exponential <- c()
for (i in 1 : 1000) {
    mean_sample_exponential = c(mean_sample_exponential,
                                base::mean(stats::rexp(n = 40, rate = 0.2)))
}
```

The `mean_sample_exponential` is a vector, 1000 in length, representing the mean of each simulation of 40 samples.

## 5. Results

Please find below the answer to each question of the exponential function dataset.

### 5.1. Sample Mean versus Theoretical Mean

> Task 1: Show the sample mean and compare it to the theoretical mean of the distribution.

**Theoretical Mean**: The Theoretical mean of an exponential distribution is the inverse of lambda.

```{r theo_mean,echo=TRUE}
# Calculating the Theoretical Mean.
theoretical_mean <- 1 / lambda
```

So in this exercise, the theoretical mean is `r theoretical_mean`.

**Sample Mean**: The sample mean is shown below.

```{r sample_mean,echo=TRUE}
# Calculating the Sample Mean of each simulation.
sample_mean <- mean(mean_sample_exponential)
```

Thus, the sample mean is `r sample_mean`.

**Conclusions**

Based on the results above, those means are very close due to the significant amount of samples and simulations. This exercise shows the concepts of the Central Limit Theorem.

### 5.2. Sample Variance  versus Theoretical Variance

> Task 2: Show how variable the sample is (via variance) and compare it to the theoretical variance of the distribution.

To calculate the variance is necessary one step before calculating the standard deviation. Thus, this section is divided into 2 steps.

**Theoretical Standard Deviation**: The standard deviation is calculated analytically.

```{r theo_sd,echo=TRUE}
# Using the formula to calculate Theoretical Standard Deviation
theoretical_sd <- (1/lambda)/(base::sqrt(sample_size))
```

So in this exercise, the theoretical standard deviation is `r theoretical_sd`.

**Sample Standard Deviation**: The sample standard deviation is shown below
```{r sample_sd,echo=TRUE}
# Using the sample to calculate the empirical value.
sample_sd <- stats::sd(mean_sample_exponential)
```

The sample standard deviation is `r sample_sd`.

Using the standard deviation calculated above. It is possible to calculate the variances.

**Theoretical Variance**: The Variance is the square of the standard deviation
```{r theo_variance,echo=TRUE}
# Calculating the Theoretical variance.
theoretical_varicane <- theoretical_sd^2
```
So in this exercise the theorical variance is `r theoretical_varicane`.

**Sample Variance**:
```{r sample_variance,echo=TRUE}
# Calculating the sample variance.
sample_variance <- stats::sd(mean_sample_exponential)^2
```

The sample variance is `r sample_variance`.

**Conclusions**

Based on the results above, those variances are very close due to the significant amount of samples and simulations. This exercise shows the concepts of the Central Limit Theorem.

### 5.3. Show that the distribution is approximately normal

> Task 3: Show that the distribution is approximately normal.

This question will be quickly answered using a graph.

```{r is_normal,echo=FALSE,fig.cap="Comparison between Theoretical and Simulation outcomes. Graph Source Code in Appendix."}
# Density Histogram of averages
hist(mean_sample_exponential, breaks = 75,
     main = "Comparison between Theoretical and Simulation outcomes",
     xlab = "Sample Average", ylab = "Frequency")

# Draw a line of Density of the averages of samples
lines(stats::density(mean_sample_exponential)$x,
      stats::density(mean_sample_exponential)$y * 100, # Converting density into absolute value.
      lwd = 2,
      col = "red")

# Theoretical center of distribution. In other words, the theoretical mean.
abline(v = 1/lambda, col="orange", lwd = 2)

# Theoretical density of the averages of the simulations samples
xfit <- base::seq(min(mean_sample_exponential),
                  base::max(mean_sample_exponential),
                  length = 100)
yfit <- stats::dnorm(x = xfit,
                     mean = 1/lambda,
                     sd = (1/lambda/sqrt(sample_size)))

# Draw a line of Theoretical
lines(xfit,
      yfit * 100, # Converting density into absolute value.
      pch = 20,
      col = "blue",
      lty = 4,
      lwd = 2)

# Add legend in the histogram
legend('topright',
       c("simulation", "normal", "mean"),
       lty = c(1,2,1),
       col = c("red", "blue", "orange"),
       lwd = 2)
```

**Conclusions**

The histogram from the mean of 1000 simulations has proved the so-called bell curve, which we could understand as a normal distribution. To ensure this understanding, I have plotted two lines, the red one is the simulation, and the blue one is the theoretical density curve (normal). From the results of this graph, the behavior of the Central Limit Theorem is clear.

<!-- Adding a Page Break to starting a new APPENDIX page -->
\newpage

\center

# APPENDIX

\raggedright

In order to reproduce this Course Project in any environment, please find below the Packages, Seed definition and `SessionInfo()`.

## A1. Requirements

```r
# Loading libraries
library(ggplot2)

# Force results to be in English
Sys.setlocale("LC_ALL", "English.utf8")

# Set seed
set.seed(2022)
```

## A2. Session Info

```{r,echo=FALSE}
sessionInfo()
```


## A3. Figure 1 - Source Code

```r
# Density Histogram of averages
hist(mean_sample_exponential, breaks = 75,
     main = "Comparison between Theoretical and Simulation outcomes",
     xlab = "Sample Average", ylab = "Frequency")

# Draw a line of Density of the averages of samples
lines(stats::density(mean_sample_exponential)$x,
      stats::density(mean_sample_exponential)$y * 100, # Converting density into absolute value.
      lwd = 2,
      col = "red")

# Theoretical center of distribution. In other words, the theoretical mean.
abline(v = 1/lambda, col="orange", lwd = 2)

# Theoretical density of the averages of the simulations samples
xfit <- base::seq(min(mean_sample_exponential),
                  base::max(mean_sample_exponential),
                  length = 100)
yfit <- stats::dnorm(x = xfit,
                     mean = 1/lambda,
                     sd = (1/lambda/sqrt(sample_size)))

# Draw a line of Theoretical
lines(xfit,
      yfit * 100, # Converting density into absolute value.
      pch = 20,
      col = "blue",
      lty = 4,
      lwd = 2)

# Add legend in the histogram
legend('topright',
       c("simulation", "normal", "mean"),
       lty = c(1,2,1),
       col = c("red", "blue", "orange"),
       lwd = 2)
```