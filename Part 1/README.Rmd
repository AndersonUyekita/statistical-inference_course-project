---
author: 'Anderson Hitoshi Uyekita'
date: !r lubridate::today(tzone = "America/Sao_Paulo")
output:
  pdf_document
---

# Statistical inference - Course Project: Part 1

* Author: `r 'Anderson Hitoshi Uyekita'`
* Date: `r format(lubridate::today(tzone = "America/Sao_Paulo"), "%A, %d %B %Y")`

## Synopsis

This exercise aims to show the power of the central limit theorem (CLT), comparing simulation results with theoretical expectations. The activity is based on a sample of 1,000 means generated by 40 numbers (with an exponential distribution profile with lambda 0.2). Then comparing those values (the sample and theoretical) to prove the CLT. As a result, a graph was plotted showing the normality of the sample's average, confirming the CLT.

## 1. Objectives

* Task 1: Show the sample mean and compare it to the theoretical mean of the distribution.
* Task 2: Show how variable the sample is (via variance) and compare it to the theoretical variance of the distribution.
* Task 3: Show that the distribution is approximately normal.

## 2. Requeriments and Settings

Please find the Requirements and Settings to reproduce this experiment in the APPENDIX section or Forking the [Github Repository](https://github.com/AndersonUyekita/statistical-inference_course-project).

```{r loading_packages,echo=FALSE,warning=FALSE}
# Loading libraries
library(ggplot2)

# Force results to be in English
base::invisible(Sys.setlocale("LC_ALL","English"))

# Set seed
base::set.seed(2022)
```

## 3. Parameters

According to Part 1 of the Course Project, the parameters of this assignment should be:

```{r sampling_settings, echo = TRUE}
# Parameters
simulations <- 1000; sample_size <- 40; lambda <- 0.2
```

## 4. Simulations

Generating random data to create a dataset to answer the tasks posted on "1. Objectives".

```{r sampling, echo = TRUE}
# Generating the dataset. Columns = simulations. Rows = Samples.
raw_sample_exponential <- base::replicate(n = simulations, expr = rexp(sample_size, lambda))

# Calculating the mean of each simulation.
mean_sample_exponential <- base::apply(X = raw_sample_exponential, MARGIN = 2, FUN = mean)
```

The `mean_sample_exponential` is a vector, 1000 in length, representing the mean of each simulation of 40 samples.

## 5. Results

Please find below the answer to each ta based on the `mean_sample_exponential` dataset.

### 5.1. Sample Mean versus Theoretical Mean

> Task 1: Show the sample mean and compare it to the theoretical mean of the distribution.

**Theoretical Mean**: The Theoretical mean of an exponential distribution rate is the inverse of lambda.

```{r theo_mean, echo = TRUE}
# Calculating the Theoretical Mean.
theoretical_mean <- 1 / lambda
```

So in this exercise, the theoretical mean is `r theoretical_mean`.

**Sample Mean**: The sample mean is shown below.

```{r sample_mean, echo = TRUE}
# Calculating the Sample Mean using the Bootstrapping technique
sample_mean <- mean(mean_sample_exponential)
```

Thus, the sample mean is `r sample_mean`.

**Conclusions**

Based on the results above, those means are very close due to the significant amount of samples and simulations. This exercise shows the concepts of the Central Limit Theorem.

### 5.2. Sample Variance  versus Theoretical Variance

> Task 2: Show how variable the sample is (via variance) and compare it to the theoretical variance of the distribution.

To calculate the variance is necessary one step before calculating the standard deviation. Thus, this section is divided into 2 parts.

**Theoretical Standard Deviation**: The standard deviation is calculated analytically as follow

```{r theo_sd, echo = TRUE}
theoretical_sd <- (1/lambda)/(sqrt(sample_size))
```

So in this exercise the theorical standard deviantion is `r theoretical_sd`.

**Sample Standard Deviation**: The sample standard deviation is showed bellow 
```{r sample_sd, echo = TRUE}
sample_sd <- sd(mean_sample_exponential)
```

The sample standard deviation is `r sample_sd`.

Using the standard deviation calculated above. It is possible to calculate the variances.

**Theoretical Variance**: The Variance is the square of the standard deviation
```{r theo_variance, echo = TRUE}
theoretical_varicane <- theoretical_sd^2
```
So in this exercise the theorical variance is `r theoretical_varicane`.

**Sample Variance**:
```{r sample_variance, echo = TRUE}
sample_variance <- sd(mean_sample_exponential)^2
```
The sample variance is `r sample_variance`.

**Conclusions**

Based on the results above, those means are very close due to the significant amount of samples and simulations. This exercise shows the concepts of the Central Limit Theorem.

### 5.3. Show that the distribution is approximately normal

> Task 3: Show that the distribution is approximately normal.

Using graphs this question could be easily answered

```{r is_normal,echo=FALSE,fig.cap="teste"}
# Histogram of averages
hist(mean_sample_exponential, breaks=20, prob=TRUE,
     main="Comparison of simulation results and theoretical expected \n (lambda=0.2)",
     xlab="")

# Draw a line of Density of the averages of samples
lines(density(mean_sample_exponential),lwd=2,col="red")

# Theoretical center of distribution. In other words, the theretical mean.
abline(v=1/lambda, col="orange",lwd=2)

# Theoretical density of the averages of the simulations samples
xfit <- seq(min(mean_sample_exponential), max(mean_sample_exponential), length=100)
yfit <- dnorm(xfit, mean=1/lambda, sd=(1/lambda/sqrt(sample_size)))

# Draw a line of Theoretical
lines(xfit, yfit, pch=20, col="blue", lty=4,lwd=2)

# Add legend in the histogram
legend('topright', c("simulation", "theoretical", "mean"), lty=c(1,2,1), col=c("red", "blue", "orange"),lwd=2)
```

**Conclusions**

The simulation is approximately normal. The graphic shows a histogram and a density line of a theoretical distribution, those information are very close. Due to the central limit theorem, the averages of samples follow normal distribution.


<!-- Adding a Page Break to starting a new APPENDIX page -->
\newpage

\center

# APPENDIX

\raggedright

In order to reproduce this Course Project in any environment, please find below the Packages, Seed definition and `SessionInfo()`.

### Requirements

```r
# Loading libraries
library(ggplot2)

# Force results to be in English
Sys.setlocale("LC_ALL","English")

# Set seed
set.seed(2022)
```

### Session Info

```{r,echo=FALSE}
sessionInfo()
```




```r
# Histogram of averages
hist(mean_sample_exponential, breaks=20, prob=TRUE,
     main="Comparison of simulation results and theoretical expected (lambda=0.2)",
     xlab="")

# Draw a line of Density of the averages of samples
lines(density(mean_sample_exponential),lwd=2,col="red")

# Theoretical center of distribution. In other words, the theretical mean.
abline(v=1/lambda, col="red",lwd=2)

# Theoretical density of the averages of the simulations samples
xfit <- seq(min(mean_sample_exponential), max(mean_sample_exponential), length=100)
yfit <- dnorm(xfit, mean=1/lambda, sd=(1/lambda/sqrt(sample_size)))

# Draw a line of Theoretical
lines(xfit, yfit, pch=20, col="blue", lty=4,lwd=2)

# Add legend in the histogram
legend('topright', c("simulation", "theoretical"), lty=c(1,2), col=c("red", "blue"),lwd=2)
```